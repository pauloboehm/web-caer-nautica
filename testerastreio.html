<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Comparação Geolocation</title>
</head>
<body>
<h2>Contador de chamadas</h2>
<p>watchPosition: <span id="watchCount">0</span></p>
<p>getCurrentPosition (1s): <span id="intervalCount">0</span></p>
<button id="parar">Parar</button>

<script>
const watchDisplay = document.getElementById("watchCount");
const intervalDisplay = document.getElementById("intervalCount");

let watchCalls = 0;
let intervalCalls = 0;

// --- WATCHPOSITION ---
let watchId = navigator.geolocation.watchPosition(
  pos => {
    watchCalls++;
    watchDisplay.innerText = watchCalls;
    console.log("watchPosition:", pos.coords.latitude, pos.coords.longitude);
  },
  err => console.error("watchPosition erro:", err),
  {
    enableHighAccuracy: true,
    timeout: 5000,
    maximumAge: 1000 // aceita posição até 1s antiga
  }
);

// --- GETCURRENTPOSITION + setInterval ---
let intervalId = setInterval(() => {
  navigator.geolocation.getCurrentPosition(
    pos => {
      intervalCalls++;
      intervalDisplay.innerText = intervalCalls;
      console.log("getCurrentPosition:", pos.coords.latitude, pos.coords.longitude);
    },
    err => console.error("getCurrentPosition erro:", err),
    {
      enableHighAccuracy: true,
      timeout: 5000,
      maximumAge: 0
    }
  );
}, 1000);

// --- Botão parar ---
document.getElementById("parar").addEventListener("click", () => {
  navigator.geolocation.clearWatch(watchId);
  clearInterval(intervalId);
  console.log("Rastreamento parado");
});
</script>
</body>
</html>
